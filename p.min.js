(function(e){if(typeof module!=="undefined"&&module&&module.exports){module.exports=e()}else if(typeof define!=="function"){define(e)}else{P=e()}})(function(){"use strict";var e={f:null,w:false,n:null},n=e,t=true,o=0,i=0,f,r,u=s(typeof window)&&window||s(typeof worker)&&worker;function l(){--o;while(e.n){e=e.n;if(e.w){--i}var n=e.f;e.f=null;n()}t=true}function c(e,f){if(t&&++i>o){++o;r(l,0)}n=n.n={f:e,w:t,n:null};t=f===true}function s(e){return e==="object"||e==="function"}function a(e){return e==="function"}if(s(typeof process)&&process&&a(typeof process.nextTick)){r=process.nextTick}else if(u&&a(typeof u.setImmediate)){r=function(e){u.setImmediate(e)}}else if(a(typeof MessageChannel)){f=new MessageChannel;f.port1.onmessage=l;r=function(){f.port2.postMessage(0)}}else{r=setTimeout;if(u&&s(typeof Image)&&Image){(function(){var e=0;var n=function(e){var n=new Image;n.onerror=e;n.src="data:image/png,"};try{n(function(){if(--e===0){r=n}});++e}catch(t){}e&&setTimeout(function(){e=0},0)})()}}function p(e,n){for(var t=0,o=e.length;t<o;++t){if(t in e){n(e[t],t)}}}function v(e){if(e instanceof h){return e}var n=d();n.resolve(e);return n.promise}v.defer=d;function d(){var e=[],n=false,t=new h(i),o;function i(t,i){var f=d();function r(){var e=n?i:t;if(typeof e==="function"){try{f.resolve(e(o))}catch(r){f.reject(r)}}else if(n){f.reject(o)}else{f.fulfill(o)}}if(e){e.push(r)}else{c(r)}return f.promise}function f(n){if(e){if(n&&typeof n.then==="function"){n.then(r,u)}else{r(n)}}}function r(i){if(e){t.state=n?"rejected":"fulfilled";t.value=o=i;p(e,c);e=null}}function u(t){if(e){n=true;r(t)}}return{promise:t,resolve:f,fulfill:r,reject:u}}function h(e){this.then=e;this.state="pending";this.value=void 0}h.prototype.done=function(e,n){var t=this;if(e||n){t=t.then(e,n)}t.then(null,function(e){c(function(){if(v.onerror){v.onerror(e)}else{throw e}},true)})};h.prototype.spread=function(e,n){return this.then(e&&function(n){return e.apply(void 0,n)},n)};v.all=m;function m(e){var n=0;var t=d();p(e,function(o,i){++n;v(o).then(function(o){e[i]=o;if(--n===0){t.fulfill(e)}},t.reject)});if(n===0){t.fulfill(e)}return t.promise}v.allResolved=y;function y(e){var n=1;var t=d();function o(){if(--n===0){t.fulfill(e)}}p(e,function(e){++n;v(e).then(o,o)});o();return t.promise}v.onerror=null;v.prototype=h.prototype;v.nextTick=function(e){c(e,true)};return v});