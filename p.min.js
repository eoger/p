(function(e){if(typeof module!=="undefined"&&module&&module.exports){module.exports=e()}else if(typeof define==="function"&&define.amd){define(e)}else{P=e()}})(function(){"use strict";var e=i(),n,t=null;function r(e){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e)||/at ([^ ]+):(\d+):(?:\d+)$/.exec(e)||/.*@(.+):(\d+)$/.exec(e);return n?{fileName:n[1],lineNumber:Number(n[2])}:null}function i(){var e=(new Error).stack;if(!e){return 0}var t=e.split("\n");var i=t[0].indexOf("@")>0?t[1]:t[2];var o=r(i);if(!o){return 0}n=o.fileName;return o.lineNumber}function o(e,n){var t=e.split("\n");var r=[];for(var i=n|0,o=t.length;i<o;++i){var l=t[i];if(l&&!u(l)&&!a(l)){r.push(l)}}return r.join("\n")}function u(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function a(t){var i=r(t);return!!i&&i.fileName===n&&i.lineNumber>=e&&i.lineNumber<=an}var l="\nFrom previous event:\n";function f(e){if(e instanceof Error&&e.stack&&e.stack.indexOf(l)===-1){var n=[o(e.stack,0)];var r=t;var i=512;while(r&&--i){var u=r.stack&&o(r.stack,2);if(u){n.push(u)}r=r.parent}var a=n.join(l);e.stack=a}}var s=T(typeof process)&&process!=null&&{}.toString.call(process)==="[object process]",c=typeof setImmediate==="function",p=T(typeof MutationObserver)&&MutationObserver||T(typeof WebKitMutationObserver)&&WebKitMutationObserver,v=new j,d=v,h=false,_=0,m=s?$:p?A(N):K(N),y=[],b=K(E),w,g,k=T.call,x=T.apply;d.next=v;function j(){this.task=null;this.a=null;this.b=null;this.domain=null;this.trace=null;this.next=null}function T(e){return e==="object"||e==="function"}function E(){if(y.length){throw y.shift()}}function N(){while(v!==d){v=v.next;if(_>=1024){d.next=d.next.next}else{++_}t=v.trace;if(v.domain){S(v.domain,v.task,v.a,v.b,void 0);v.domain=null}else{(1,v.task)(v.a,v.b)}v.task=null;v.a=null;v.b=null;v.trace=null}h=false;t=null}function O(){v.task=null;v.a=null;v.b=null;v.domain=null;v.trace=null;m()}function S(e,n,t,r,i){if(e._disposed){return}e.enter();n(t,r,i);e.exit()}function I(e,n,r){var i=s?process.domain:null;var o=B.longStackSupport?{parent:t,stack:(new Error).stack}:null;M(e,n,r,i,o)}function M(e,n,t,r,i){var o=d.next;if(o===v){o=new j;d.next=o;o.next=v}else{--_}d=o;o.task=e;o.a=n;o.b=t;o.domain=r;o.trace=i;if(!h){h=true;m()}}function $(){var e=process.domain;if(e){if(!g)g=(1,require)("domain");g.active=process.domain=null}if(h&&c){setImmediate(N)}else{process.nextTick(N)}if(e){g.active=process.domain=e}}function A(e){var n=1;var t=document.createTextNode("");var r=new p(e);r.observe(t,{characterData:true});return function(){n=-n;t.data=n}}function K(e){return function(){var n=setTimeout(r,0);var t=setInterval(r,50);function r(){clearTimeout(n);clearInterval(t);e()}}}if(s){w=function(e){O();throw e}}else{w=function(e){y.push(e);b()}}function W(e,n){try{e.call()}catch(t){n(t)}}function q(e){I(W,e,w)}function D(e,n){for(var t=0,r=e.length;t<r;++t){if(t in e){n(e[t],t)}}}function F(e){q(function(){if(B.onerror){B.onerror.call(null,e)}else{throw e}})}var P=0;var Y=1;var z=2;function B(e){return e instanceof nn?e:J(new nn,e,false)}B.longStackSupport=false;function C(e,n){if(e._state){return}e._state=Y;e._value=n;if(e._pending){Q(e)}}function G(e,n){if(e._state){return}if(t){f(n)}e._state=z;e._value=n;if(s){e._domain=process.domain}if(e._pending){Q(e)}}function H(e,n){if(n._state){return}n._state=e._state;n._value=e._value;n._domain=e._domain;if(n._pending){Q(n)}}function J(e,n,t){if(e._state){return e}if(n instanceof nn){if(n===e){G(e,new TypeError("You can't resolve a promise with itself"))}else if(n._state){H(n,e)}else{R(e,n)}}else if(n!==Object(n)){C(e,n)}else if(t){L(e,n)}else{I(L,e,n)}return e}function L(e,n){var t,r;try{r=n.then}catch(i){G(e,i);return}if(typeof r==="function"){t=X(e);try{k.call(r,n,t.resolve,t.reject)}catch(o){t.reject(o)}}else{C(e,n)}}function Q(e){var n=e._pending;e._pending=null;if(n instanceof nn){M(U,e,n,null,n._trace);return}for(var t=0,r=n.length;t<r;++t){M(U,e,n[t],null,n[t]._trace)}}function R(e,n){if(!n._pending){n._pending=e}else if(n._pending instanceof nn){n._pending=[n._pending,e]}else{n._pending.push(e)}}function U(e,n){var t=e._state===Y?n._cb:n._eb;n._cb=null;n._eb=null;if(!t){H(e,n);return}var r=e._domain||n._domain;if(r){n._domain=null;S(r,V,t,n,e._value)}else{V(t,n,e._value)}}function V(e,n,t){var r;try{r=e(t)}catch(i){G(n,i);return}J(n,r,true)}function X(e){var n=false;return{promise:e,resolve:function(t){if(!n){n=true;J(e,t,false)}},reject:function(t){if(!n){n=true;G(e,t)}}}}B.defer=Z;function Z(){return X(new nn)}B.reject=en;function en(e){var n=new nn;G(n,e);return n}function nn(){this._state=0;this._value=void 0;this._domain=null;this._cb=null;this._eb=null;this._pending=null;this._trace=null}nn.prototype.then=function(e,n){var r=new nn;if(B.longStackSupport){r._trace={parent:t,stack:(new Error).stack}}r._cb=typeof e==="function"?e:null;r._eb=typeof n==="function"?n:null;if(s){r._domain=process.domain}if(this._state===P){R(r,this)}else{M(U,this,r,null,r._trace)}return r};nn.prototype.done=function(e,n){var t=this;if(e||n){t=t.then(e,n)}t.then(null,F)};nn.prototype.fail=function(e){return this.then(null,e)};nn.prototype._always=function(e){return this.then(e,e)};nn.prototype.spread=function(e,n){return this.then(e&&function(t){return on(t).then(function(n){return x.call(e,void 0,n)},n)},n)};function tn(e,n){if(t){var r=t;return setTimeout(function(){t=r;e();t=null},n)}return setTimeout(e,n)}nn.prototype.timeout=function(e,n){var t=this;var r=new nn;if(t._state!==P){H(t,r)}else{var i=tn(function(){G(r,new Error(n||"Timed out after "+e+" ms"))},e);t._always(function(){clearTimeout(i);H(t,r)})}return r};nn.prototype.delay=function(e){var n=Z();this.then(function(t){tn(function(){n.resolve(t)},e)},n.reject);return n.promise};nn.prototype.all=function(){return this.then(on)};nn.prototype.allSettled=function(){return this.then(rn)};nn.prototype.inspect=function(){switch(this._state){case P:return{state:"pending"};case Y:return{state:"fulfilled",value:this._value};case z:return{state:"rejected",reason:this._value};default:throw new TypeError("invalid state")}};nn.prototype.nodeify=function(e){if(e){this.done(function(n){e(null,n)},e);return void 0}else{return this}};B.allSettled=rn;function rn(e){var n=new nn;if(typeof e.length!=="number"){G(n,new TypeError("input not array-like"));return n}var t=0;var r=new Array(e.length);D(e,function(e,i){var o=B(e);if(o._state===P){++t;o._always(function(){r[i]=o.inspect();if(--t===0){C(n,r)}})}else{r[i]=o.inspect()}});if(t===0){C(n,r)}return n}B.all=on;function on(e){var n=Z();if(typeof e.length!=="number"){n.reject(new TypeError("input not array-like"));return n.promise}var t=0;var r=new Array(e.length);D(e,function(e,i){var o=B(e);if(o._state===Y){r[i]=o._value}else{++t;o.then(function(e){r[i]=e;if(--t===0){n.resolve(r)}},n.reject)}});if(t===0){n.resolve(r)}return n.promise}B.promised=un;function un(e){function n(n){return x.apply(e,n)}return function(){return on([this,on(arguments)]).then(n)}}B.onerror=null;B.nextTick=q;var an=i();return B});