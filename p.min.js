(function(e){if(typeof module!=="undefined"&&module&&module.exports){module.exports=e()}else if(typeof define==="function"&&define.amd){define(e)}else{P=e()}})(function(){"use strict";var e=i(),n,t=null;function r(e){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e)||/at ([^ ]+):(\d+):(?:\d+)$/.exec(e)||/.*@(.+):(\d+)$/.exec(e);return n?{fileName:n[1],lineNumber:Number(n[2])}:null}function i(){var e=(new Error).stack;if(!e){return 0}var t=e.split("\n");var i=t[0].indexOf("@")>0?t[1]:t[2];var a=r(i);if(!a){return 0}n=a.fileName;return a.lineNumber}function a(e,n){var t=e.split("\n");var r=[];for(var i=n|0,a=t.length;i<a;++i){var l=t[i];if(l&&!o(l)&&!u(l)){r.push(l)}}return r.join("\n")}function o(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function u(t){var i=r(t);return!!i&&i.fileName===n&&i.lineNumber>=e&&i.lineNumber<=ln}var l="\nFrom previous event:\n";function f(e){if(e instanceof Error&&e.stack&&e.stack.indexOf(l)===-1){var n=[a(e.stack,0)];var r=t;var i=512;while(r&&--i){var o=r.stack&&a(r.stack,2);if(o){n.push(o)}r=r.parent}var u=n.join(l);e.stack=u}}var s=T(typeof process)&&process!=null&&{}.toString.call(process)==="[object process]",c=typeof setImmediate==="function",p=T(typeof MutationObserver)&&MutationObserver||T(typeof WebKitMutationObserver)&&WebKitMutationObserver,d=new j,v=d,_=false,h=0,m=s?M:p?$(N):K(N),y=[],b=K(E),g,w,x=T.call,k=T.apply;v.next=d;function j(){this.task=null;this.a=null;this.b=null;this.domain=null;this.trace=null;this.next=null}function T(e){return e==="object"||e==="function"}function E(){if(y.length){throw y.shift()}}function N(){while(d!==v){d=d.next;if(h>=1024){v.next=v.next.next}else{++h}t=d.trace;if(d.domain){S(d.domain,d.task,d.a,d.b);d.domain=null}else{(1,d.task)(d.a,d.b)}d.task=null;d.a=null;d.b=null;d.trace=null}_=false;t=null}function O(){d.task=null;d.a=null;d.b=null;d.domain=null;d.trace=null;m()}function S(e,n,t,r){if(e._disposed){return}e.enter();n(t,r);e.exit()}function A(e,n,r){var i=s?process.domain:null;var a=B.longStackSupport?{parent:t,stack:(new Error).stack}:null;I(e,n,r,i,a)}function I(e,n,t,r,i){var a=v.next;if(a===d){a=new j;v.next=a;a.next=d}else{--h}v=a;a.task=e;a.a=n;a.b=t;a.domain=r;a.trace=i;if(!_){_=true;m()}}function M(){var e=process.domain;if(e){if(!w)w=(1,require)("domain");w.active=process.domain=null}if(_&&c){setImmediate(N)}else{process.nextTick(N)}if(e){w.active=process.domain=e}}function $(e){var n=1;var t=document.createTextNode("");var r=new p(e);r.observe(t,{characterData:true});return function(){n=-n;t.data=n}}function K(e){return function(){var n=setTimeout(r,0);var t=setInterval(r,50);function r(){clearTimeout(n);clearInterval(t);e()}}}if(s){g=function(e){O();throw e}}else{g=function(e){y.push(e);b()}}function W(e,n){try{e.call()}catch(t){n(t)}}function q(e){A(W,e,g)}var D=0;var F=1;var P=2;function Y(e){if(e._state===P){I(z,e._value,g,e._domain,null)}}function z(e,n){if(B.onerror){try{(1,B.onerror)(e)}catch(t){n(t)}}else{n(e)}}function B(e){return e instanceof tn?e:J(new tn,e,false)}B.longStackSupport=false;function C(e,n){if(e._state){return}e._state=F;e._value=n;if(e._pending){Q(e,e._pending);e._pending=null}}function G(e,n){if(e._state){return}if(t){f(n)}e._state=P;e._value=n;if(s){e._domain=process.domain}if(e._pending){Q(e,e._pending);e._pending=null}}function H(e,n){if(n._state){return}n._state=e._state;n._value=e._value;n._domain=e._domain;if(n._pending){Q(n,n._pending);n._pending=null}}function J(e,n,t){if(e._state){return e}if(n instanceof tn){if(n===e){G(e,new TypeError("You can't resolve a promise with itself"))}else if(n._state){H(n,e)}else{R(n,e)}}else if(n!==Object(n)){C(e,n)}else if(t){L(e,n)}else{A(L,e,n)}return e}function L(e,n){var t,r;try{r=n.then}catch(i){G(e,i);return}if(typeof r==="function"){t=Z(e);try{x.call(r,n,t.resolve,t.reject)}catch(a){t.reject(a)}}else{C(e,n)}}function Q(e,n){if(typeof n==="function"){n(e,e._index)}else if(n instanceof tn){I(V,e,n,e._domain||n._domain,n._trace)}else{for(var t=0,r=n.length;t<r;++t){Q(e,n[t])}}}function R(e,n){if(e._state){Q(e,n)}else if(!e._pending){e._pending=n}else if(e._pending instanceof Array){e._pending.push(n)}else{e._pending=[e._pending,n]}}function U(e,n,t){if(e._state){t(e,n)}else if(!e._pending){e._pending=t;e._index=n}else{R(n===e._index?t:function(e,r){t(e,n)})}}function V(e,n){var t=e._state===F?n._cb:n._eb;n._cb=null;n._eb=null;n._domain=null;if(t===null){H(e,n)}else{X(n,t,e._value)}}function X(e,n,t){var r;try{r=n(t)}catch(i){G(e,i);return}J(e,r,true)}function Z(e){var n=false;return{promise:e,resolve:function(t){if(!n){n=true;J(e,t,false)}},reject:function(t){if(!n){n=true;G(e,t)}}}}B.defer=en;function en(){return Z(new tn)}B.reject=nn;function nn(e){var n=new tn;G(n,e);return n}function tn(){this._state=0;this._value=void 0;this._domain=null;this._cb=null;this._eb=null;this._index=0;this._pending=null;this._trace=null}tn.prototype.then=function(e,n){var r=new tn;if(B.longStackSupport){r._trace={parent:t,stack:(new Error).stack}}r._cb=typeof e==="function"?e:null;r._eb=typeof n==="function"?n:null;if(s){r._domain=process.domain}R(this,r);return r};tn.prototype.done=function(e,n){var t=this;if(e||n){t=t.then(e,n)}R(t,Y)};tn.prototype.fail=function(e){return this.then(null,e)};tn.prototype.spread=function(e,n){return this.then(an).then(function(n){return k.call(e,void 0,n)},n)};tn.prototype.timeout=function(e,n){var r=new tn;if(this._state!==D){H(this,r)}else{var i=t;var a=setTimeout(function(){t=i;G(r,new Error(n||"Timed out after "+e+" ms"))},e);R(this,function(e){clearTimeout(a);H(e,r)})}return r};tn.prototype.delay=function(e){var n=en();this.then(function(r){var i=t;setTimeout(function(){t=i;n.resolve(r)},e)},n.reject);return n.promise};tn.prototype.all=function(){return this.then(an)};tn.prototype.allSettled=function(){return this.then(rn)};tn.prototype.inspect=function(){switch(this._state){case D:return{state:"pending"};case F:return{state:"fulfilled",value:this._value};case P:return{state:"rejected",reason:this._value};default:throw new TypeError("invalid state")}};tn.prototype.nodeify=function(e){if(e){this.done(function(n){e(null,n)},e);return void 0}else{return this}};B.allSettled=rn;function rn(e){var n=new tn;var t=e.length;if(typeof t!=="number"){G(n,new TypeError("input not array-like"));return n}var r=0;var i=new Array(t);function a(e,t){i[t]=e.inspect();if(--r===0){C(n,i)}}for(var o=0;o<t;++o){if(o in e){var u=B(e[o]);if(u._state){i[o]=u.inspect()}else{++r;U(u,o,a)}}}if(r===0){C(n,i)}return n}B.all=an;function an(e){var n=new tn;var t=e.length;if(typeof t!=="number"){G(n,new TypeError("input not array-like"));return n}var r=0;var i=new Array(t);function a(e,t){if(e._state===P){H(e,n);return}i[t]=e._value;if(--r===0){C(n,i)}}for(var o=0;o<t;++o){if(o in e){var u=B(e[o]);if(u._state===F){i[o]=u._value}else if(u._state===P){H(u,n);break}else{++r;U(u,o,a)}}}if(r===0){C(n,i)}return n}B.spread=on;function on(e,n,t){return an(e).then(function(e){return k.call(n,void 0,e)},t)}B.promised=un;function un(e){function n(n){return x.apply(e,n)}return function(){var e=arguments.length;var t=new Array(e+1);t[0]=this;for(var r=0;r<e;++r){t[r+1]=arguments[r]}return an(t).then(n)}}B.onerror=null;B.nextTick=q;var ln=i();return B});